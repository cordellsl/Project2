USE GENDER_DB;


-- FIRST VERSION OF USING MYSQL 
-- PREVIOUS HIVE COMMANDS FOR A NEW TABLE
-- NOTE: ORIGINAL TABLE MUST EXIST - CHECK create.sql

DROP IF EXISTS DATA_BY_REQ;

-- USING PARTIONING TO GET SPECIFIC DATA
CREATE TABLE DATA_BY_REQ
(COUNTRY_NAME VARCHAR(200), COUNTRY_CODE VARCHAR(200), 
INDICATOR_NAME VARCHAR(200), 
`2000` FLOAT(50,8),
`2001` FLOAT(50,8), `2002` FLOAT(50,8), `2003` FLOAT(50,8), `2004` FLOAT(50,8),
`2005` FLOAT(50,8), `2006` FLOAT(50,8), `2007` FLOAT(50,8), `2008` FLOAT(50,8),
`2009` FLOAT(50,8), `2010` FLOAT(50,8), `2011` FLOAT(50,8), `2012` FLOAT(50,8),
`2013` FLOAT(50,8), `2014` FLOAT(50,8), `2015` FLOAT(50,8), `2016` FLOAT(50,8))
PARTITION BY LIST COLUMNS (INDICATOR_CODE)(
    PARTITION INDICATOR_CODE VALUES IN('WP_time_01.3', 'WP14889.3',
     'SP.HOU.FEMA.ZS', 'WP11658.3', 'SL.EMP.SELF.FE.ZS')
);


-- ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.OpenCSVSerde'
-- WITH SERDEPROPERTIES
-- (
--     "quotechar" = "\"",
--     "seperatorChar" = ","
-- );


INSERT INTO DATA_BY_REQ
SELECT COUNTRY_NAME, COUNTRY_CODE, INDICATOR_NAME,
PARTITION(INDICATOR_CODE)
    (INDICATOR_CODE)
`2000`, `2001` , `2002` , `2003` , 
`2004` , `2005` , `2006` , `2007` , `2008` ,
`2009` , `2010` , `2011` , `2012` ,
`2013` , `2014` , `2015` , `2016`
FROM data_by_country;


CREATE TABLE REQ_SOLUTION
LOCATION 'user/cloudera/hive-share/tables/'
AS
-- <SELECT COMMAND THAT WILL ANSWER BUSINESS QUESTION>
-- SELECT(((`2016` - `2000`)/ `2000`) * 100)
-- FROM DATA_BY_REQ
-- WHERE country_code = 'WLD';
